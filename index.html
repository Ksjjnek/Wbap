<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NovaChat</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body {
    font-family: Arial;
    background: #0f172a;
    color: white;
    margin: 0;
    text-align: center;
}
#registration, #chat { display: none; height: 100vh; flex-direction: column; }
#start { display: none; margin-top: 150px; }
button {
    padding: 15px 30px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    background: #3b82f6;
    color: white;
    cursor: pointer;
}
#messages {
    flex: 1;
    overflow: auto;
    padding: 20px;
    text-align: left;
}
#input {
    display: flex;
    padding: 10px;
    background: #1e293b;
}
#input input {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 8px;
}
#input button { margin-left: 10px; }
label { font-size: 14px; margin-left: 10px; }
</style>
</head>

<body>

<!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ä—Ç -->
<div id="start">
  <h1>NovaChat üí¨</h1>
  <p>–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç –≤–Ω—É—Ç—Ä–∏ Telegram</p>
  <button onclick="openRegistration()">START</button>
</div>

<!-- –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
<div id="registration">
  <h2>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏–∫ –¥–ª—è —á–∞—Ç–∞</h2>
  <input id="nickname" placeholder="–í–∞—à –Ω–∏–∫" style="padding:10px; font-size:16px;">
  <div style="margin:10px;">
    <input type="checkbox" id="announce">
    <label for="announce">–û–±—ä—è–≤–∏—Ç—å –æ –º–æ—ë–º –≤—Ö–æ–¥–µ –≤ —á–∞—Ç</label>
  </div>
  <button onclick="register()">–í–æ–π—Ç–∏ –≤ —á–∞—Ç</button>
</div>

<!-- –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ -->
<div id="chat">
  <div id="messages"></div>
  <div id="input">
    <input id="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
    <button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// üîí –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–π ID –±–æ—Ç–∞
const ALLOWED_BOT_ID = 8250250632;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–µ—Ä–µ–∑ Telegram –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–æ—Ç–∞
if(!tg.initData){
    document.body.innerHTML="‚ùå –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞";
} else if(tg.initDataUnsafe.bot_id != ALLOWED_BOT_ID){
    document.body.innerHTML="‚ùå –≠—Ç–æ—Ç WebApp —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º";
} else {
    // –í—Å—ë –æ–∫ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
    document.getElementById("start").style.display="block";
}

// –†–∞–Ω–¥–æ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
const joinMessages = [
  "–∑–∞—è–≤–∏–ª—Å—è –≤ —á–∞—Ç–µ!",
  "–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Ä–∞–∑–≥–æ–≤–æ—Ä—É!",
  "–≤–æ—à—ë–ª –≤ –∫–æ–º–Ω–∞—Ç—É!",
  "—Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ—è–≤–∏–ª—Å—è –∑–¥–µ—Å—å!"
];

const registerMessages = [
  "–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è!",
  "—Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–ª –Ω–∏–∫!",
  "–≥–æ—Ç–æ–≤ –∫ –æ–±—â–µ–Ω–∏—é!",
  "–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —á–∞—Ç—É!"
];

let nickname = null;
let showAnnouncement = true;

// –û—Ç–∫—Ä—ã—Ç–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
function openRegistration(){
  document.getElementById("start").style.display="none";
  document.getElementById("registration").style.display="block";
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function register(){
  const nickInput = document.getElementById("nickname").value.trim();
  if(nickInput === ""){
    alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å");
    return;
  }
  nickname = nickInput;
  showAnnouncement = document.getElementById("announce").checked;

  document.getElementById("registration").style.display="none";
  document.getElementById("chat").style.display="flex";

  if(showAnnouncement){
    const msg = registerMessages[Math.floor(Math.random()*registerMessages.length)];
    addMessage("–°–∏—Å—Ç–µ–º–∞", `${nickname} ${msg}`);
    tg.sendData(`SYSTEM_ANNOUNCE: ${nickname} ${msg}`);
  }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
function send(){
  const textInput = document.getElementById("text");
  let text = textInput.value.trim();
  if(text === "") return;

  addMessage(nickname, text);
  tg.sendData(text);
  textInput.value = "";
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç
function addMessage(name,text){
  const msg = document.createElement("div");
  msg.innerHTML = `<b>${name}:</b> ${text}`;
  document.getElementById("messages").appendChild(msg);
  document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
}

// –°–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ –≤ —á–∞—Ç
function joinChat(nick){
  const msg = joinMessages[Math.floor(Math.random()*joinMessages.length)];
  addMessage("–°–∏—Å—Ç–µ–º–∞", `${nick} ${msg}`);
  tg.sendData(`SYSTEM_JOIN: ${nick} ${msg}`);
}

</script>

</body>
</html><body>

<div id="start">
  <h1>NovaChat üí¨</h1>
  <p>–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç –≤–Ω—É—Ç—Ä–∏ Telegram</p>
  <button onclick="startApp()">START</button>
</div>

<div id="chat">
  <div id="messages"></div>
  <div id="input">
    <input id="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
    <button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

/* üîí –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ Telegram */
if(!tg.initData){
  document.body.innerHTML="‚ùå –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞";
}

/* –ø–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
const user = tg.initDataUnsafe.user;

function startApp(){
  document.getElementById("start").style.display="none";
  document.getElementById("chat").style.display="flex";
  addMessage("–°–∏—Å—Ç–µ–º–∞","–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, "+user.first_name+"!");
}

function send(){
  let text = document.getElementById("text").value;
  if(text=="") return;
  addMessage(user.first_name,text);
  tg.sendData(text); // –æ—Ç–ø—Ä–∞–≤–∫–∞ –±–æ—Ç—É
  document.getElementById("text").value="";
}

function addMessage(name,text){
  let msg=document.createElement("div");
  msg.innerHTML="<b>"+name+":</b> "+text;
  document.getElementById("messages").appendChild(msg);
  document.getElementById("messages").scrollTop=document.getElementById("messages").scrollHeight;
}
</script>

</body>
</html>
#messages{
flex:1;
overflow:auto;
padding:20px;
text-align:left;
}

#input{
display:flex;
padding:10px;
background:#1e293b;
}

#input input{
flex:1;
padding:10px;
border:none;
border-radius:8px;
}

#input button{
margin-left:10px;
}
</style>

</head>

<body>

<div id="start">
<h1>NovaChat üí¨</h1>
<p>–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç –≤–Ω—É—Ç—Ä–∏ Telegram</p>
<button onclick="startApp()">START</button>
</div>

<div id="chat">
<div id="messages"></div>

<div id="input">
<input id="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
<button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>
</div>

<script>

const tg = window.Telegram.WebApp;
tg.expand();

/* üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã—Ç –∏–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ Telegram */
if(!tg.initData){
document.body.innerHTML="–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞";
}

/* üîí ID —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ */
const BOT_ID = "8250250632";

/* –ø–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
const user = tg.initDataUnsafe.user;

function startApp(){
document.getElementById("start").style.display="none";
document.getElementById("chat").style.display="flex";

addMessage("–°–∏—Å—Ç–µ–º–∞","–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å "+user.first_name);
}

function send(){

let text=document.getElementById("text").value;

if(text=="") return;

addMessage(user.first_name,text);

/* –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É */
tg.sendData(text);

document.getElementById("text").value="";
}

function addMessage(name,text){

let msg=document.createElement("div");

msg.innerHTML="<b>"+name+":</b> "+text;

document.getElementById("messages").appendChild(msg);

}

</script>

</body>
</html>
